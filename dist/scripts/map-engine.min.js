"use strict";function initMap(){mapSG=new google.maps.Map(document.getElementById("map-sg"),{zoom:12,center:{lat:1.34863,lng:103.839105}});for(var t=0;locLength>t;++t)markers.push(new google.maps.Marker({position:locs[t].latLng,animation:google.maps.Animation.DROP,map:mapSG,title:locs[t].title}));infowindow=new google.maps.InfoWindow({content:contentString}),toggleBounce=function(t){if(null!==markers[t].getAnimation())markers[t].setAnimation(null);else{for(var e=0;e<markers.length;++e)markers[e].setAnimation(null);markers[t].setAnimation(google.maps.Animation.BOUNCE)}};for(var t=0;locLength>t;++t)!function(t){markers[t].addListener("click",function(){toggleBounce(t),contentString='<div id="window"><h3 id="window-title">'+locs[t].title+'</h3><div id="window-wiki"></div><div id="window-instagram"></div></div>',infowindow.setContent(contentString),infowindow.open(mapSG,markers[t]),query=locs[t].title,wikiUrl="https://en.wikipedia.org/w/api.php?action=opensearch&search="+query+"&format=json",wikiRequestTimeout=setTimeout(function(){$("#window-wiki").text("Wikipedia has no related links yet :(")},8e3),$.ajax(wikiUrl,{dataType:"jsonp"}).done(function(t){console.log(t),$("#window-wiki").empty();for(var e=[],n=0;n<t[1].length;++n)ItemHtml='<li id="wklk'+(n+1)+'" class="wiki-link"><a href="'+t[3][n]+'">'+t[1][n]+"</a></li>",e.push(ItemHtml),$("#window-wiki").append(e[n]);clearTimeout(wikiRequestTimeout)})})}(t)}function setMapOnAll(t){for(var e=0;e<markers.length;++e)markers[e].setMap(t),locs[e].disp=!0}function clearMarkers(){setMapOnAll(null);for(var t=0;t<markers.length;++t)locs[t].disp=!1}function showMarkers(){setMapOnAll(map)}function deleteMarkers(){clearMarkers(),markers=[]}function mapSGViewModel(){var t=this;t.items=ko.observableArray(locs),t.filterText=ko.observable("Filter your interest..."),t.filter=ko.computed(function(){return t.filterText().toLowerCase()}),t.filterItems=t.items(),t.filteredItems=ko.computed(function(){return t.filter()&&"filter your interest..."!=t.filter()?ko.utils.arrayFilter(t.items(),function(e){return stringStartsWith(e.title.toLowerCase(),t.filter())}):t.items()}),t.markersUpdate=function(){clearMarkers();for(var e,n=t.filteredItems().length,i=0;n>i;++i)e=t.filteredItems()[i].index,markers[e].setMap(mapSG)},t.listClick=function(t){toggleBounce(t.index),contentString='<div><h3 id="window-title">'+locs[t.index].title+"</h2></div>",infowindow.setContent(contentString),infowindow.open(mapSG,markers[t.index])},t.filterTestText=ko.computed(function(){var e="Note: "+t.filteredItems().length+' items found for query "'+t.filter()+'"'+t.infowindow;return e})}var mapSG,locs=[{index:0,title:"Nanyang Technological University",latLng:{lat:1.348283,lng:103.683119}},{index:1,title:"National University of Singapore",latLng:{lat:1.296729,lng:103.776351}},{index:2,title:"Marina Bay",latLng:{lat:1.286848,lng:103.854554}},{index:3,title:"Resorts World Sentosa",latLng:{lat:1.255145,lng:103.82181}},{index:4,title:"China Town",latLng:{lat:1.283467,lng:103.84441}},{index:5,title:"Singapore Zoo",latLng:{lat:1.404338,lng:103.792995}},{index:6,title:"Changi Airport Singapore",latLng:{lat:1.364422,lng:103.991518}},{index:7,title:"Orchard Road",latLng:{lat:1.301532,lng:103.838447}},{index:8,title:"Marina Bay Sands",latLng:{lat:1.283725,lng:103.860793}},{index:9,title:"Bukit Timah Nature Reserve",latLng:{lat:1.348399,lng:103.777454}},{index:10,title:"National Museum of Singapore",latLng:{lat:1.296562,lng:103.848561}},{index:11,title:"Clarke Quay",latLng:{lat:1.290596,lng:103.846471}},{index:12,title:"City Hall",latLng:{lat:1.290654,lng:103.851773}},{index:13,title:"Tian Tian Hainanese Chicken Rice",latLng:{lat:1.280538,lng:103.844465}},{index:14,title:"Garden by the Bay",latLng:{lat:1.281566,lng:103.863608}}],locLength=locs.length,markers=[],test,contentString="",infowindow,toggleBounce,query,wikiUrl,wikiRequestTimeout,ItemHtml,stringStartsWith=function(t,e){return t=t||"",e.length>t.length?!1:t.substring(0,e.length)===e};ko.applyBindings(new mapSGViewModel);