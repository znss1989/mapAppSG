"use strict";function initMap(){mapSG=new google.maps.Map(document.getElementById("map-sg"),{zoom:12,center:{lat:1.34863,lng:103.839105}});for(var e=0;locLength>e;++e)markers.push(new google.maps.Marker({position:locs[e].latLng,animation:google.maps.Animation.DROP,map:mapSG,title:locs[e].title}));infowindow=new google.maps.InfoWindow({content:contentString}),toggleBounce=function(e){if(null!==markers[e].getAnimation())markers[e].setAnimation(null);else{for(var t=0;t<markers.length;++t)markers[t].setAnimation(null);markers[e].setAnimation(google.maps.Animation.BOUNCE)}};for(var e=0;locLength>e;++e)!function(e){markers[e].addListener("click",function(){null==markers[e].getAnimation()&&toggleBounce(e),contentString='<div id="window"><h3 id="window-title">'+locs[e].title+'</h3><div id="window-wiki"></div><div id="window-flickr"></div></div>',infowindow.setContent(contentString),infowindow.open(mapSG,markers[e]),query=locs[e].title,wikiUrl="https://en.wikipedia.org/w/api.php?action=opensearch&search="+query+"&format=json",wikiRequestTimeout=setTimeout(function(){$("#window-wiki").text("Wikipedia has no related links yet :(")},8e3),$.ajax(wikiUrl,{dataType:"jsonp"}).done(function(e){$("#window-wiki").empty();for(var t=[],i=0;i<e[1].length;++i)ItemHtml='<li id="wklk'+(i+1)+'" class="wiki-link"><a href="'+e[3][i]+'">'+e[1][i]+"</a></li>",t.push(ItemHtml),$("#window-wiki").append(t[i]);clearTimeout(wikiRequestTimeout)}),google.maps.event.addListener(infowindow,"closeclick",function(){null!==markers[e].getAnimation()&&toggleBounce(e)})})}(e)}function setMapOnAll(e){for(var t=0;t<markers.length;++t)markers[t].setMap(e),locs[t].disp=!0}function clearMarkers(){setMapOnAll(null);for(var e=0;e<markers.length;++e)locs[e].disp=!1}function showMarkers(){setMapOnAll(map)}function deleteMarkers(){clearMarkers(),markers=[]}function mapSGViewModel(){var e=this;e.items=ko.observableArray(locs),e.filterText=ko.observable(""),e.filter=ko.computed(function(){return e.filterText().toLowerCase()}),e.filterItems=e.items(),e.filteredItems=ko.computed(function(){return e.filter()?ko.utils.arrayFilter(e.items(),function(t){return stringStartsWith(t.title.toLowerCase(),e.filter())}):e.items()}),e.markersUpdate=function(){clearMarkers();for(var t,i=e.filteredItems().length,n=0;i>n;++n)t=e.filteredItems()[n].index,markers[t].setMap(mapSG)},e.listClick=function(e){toggleBounce(e.index),contentString='<div id="window"><h3 id="window-title">'+locs[e.index].title+'</h3><div id="window-wiki"></div><div id="window-flickr"></div></div>',infowindow.setContent(contentString),infowindow.open(mapSG,markers[e.index]),query=locs[e.index].title,wikiUrl="https://en.wikipedia.org/w/api.php?action=opensearch&search="+query+"&format=json",wikiRequestTimeout=setTimeout(function(){$("#window-wiki").text("Wikipedia has no related links yet :(")},8e3),$.ajax(wikiUrl,{dataType:"jsonp"}).done(function(e){$("#window-wiki").empty();for(var t=[],i=0;i<e[1].length;++i)ItemHtml='<li id="wklk'+(i+1)+'" class="wiki-link"><a href="'+e[3][i]+'">'+e[1][i]+"</a></li>",t.push(ItemHtml),$("#window-wiki").append(t[i]);clearTimeout(wikiRequestTimeout)})},e.filterTestText=ko.computed(function(){var t="Note: "+e.filteredItems().length+' items found for query "'+e.filter()+'"';return t})}var mapSG,locs=[{index:0,title:"Nanyang Technological University",latLng:{lat:1.348283,lng:103.683119}},{index:1,title:"National University of Singapore",latLng:{lat:1.296729,lng:103.776351}},{index:2,title:"Marina Bay",latLng:{lat:1.286848,lng:103.854554}},{index:3,title:"Resorts World Sentosa",latLng:{lat:1.255145,lng:103.82181}},{index:4,title:"China Town",latLng:{lat:1.283467,lng:103.84441}},{index:5,title:"Singapore Zoo",latLng:{lat:1.404338,lng:103.792995}},{index:6,title:"Changi Airport",latLng:{lat:1.364422,lng:103.991518}},{index:7,title:"Orchard Road",latLng:{lat:1.301532,lng:103.838447}},{index:8,title:"Marina Bay Sands",latLng:{lat:1.283725,lng:103.860793}},{index:9,title:"Bukit Timah Nature Reserve",latLng:{lat:1.348399,lng:103.777454}},{index:10,title:"National Museum of Singapore",latLng:{lat:1.296562,lng:103.848561}},{index:11,title:"Clarke Quay",latLng:{lat:1.290596,lng:103.846471}},{index:12,title:"City Hall",latLng:{lat:1.290654,lng:103.851773}},{index:13,title:"Tian Tian Hainanese Chicken Rice",latLng:{lat:1.280538,lng:103.844465}},{index:14,title:"Garden by the Bay",latLng:{lat:1.281566,lng:103.863608}}],locLength=locs.length,markers=[],test,contentString="",infowindow,toggleBounce,query,wikiUrl,wikiRequestTimeout,ItemHtml,stringStartsWith=function(e,t){return e=e||"",t.length>e.length?!1:e.substring(0,t.length)===t};$("#menu-toggle").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled")}),ko.applyBindings(new mapSGViewModel);